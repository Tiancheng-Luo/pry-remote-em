#!/usr/bin/env ruby

$: << File.expand_path("../../lib", __FILE__)

require 'uri'
require 'pry-remote-em/client'

uri = ARGV[0] || "pryem://localhost:#{PryRemoteEm::DEFPORT}"
uri = URI.parse(uri)
unless %w(pryem pryems).include?(uri.scheme)
  abort "only pryem URIs are currently supported\n usage: pryem(s)://127.0.0.1:#{PryRemoteEm::DEFPORT}" 
end

EM.run do
  PryRemoteEm::Client.start(uri.host, uri.port, :tls => uri.scheme == 'pryems') do |e|
    EM.stop
  end 
end
